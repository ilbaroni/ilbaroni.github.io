---
layout: post
title:  "MMON Point-Of-Sale malware"
date:   2021-03-07
categories: reversing
---


## Introduction

This family is around since 2010 and according to a Visa report (September 2020) this malware was used in an intrusion of a North American merchant. Visa also states that the code of MMon has been used as a base for multiple point-of-sale (POS) malware families, such as: JavalinPOS, BlackPOS, POSRAM and more.



## MMon Analysis

The PDB `mmon.pdb` is a good indicator to identify samples that are based on MMon.

![ ](/assets/images/mmon/image-20210301005949831.png)



MMon supports a couple command line options. It can scan all processes or specific processes and it can scan for kartoxa (card data) and also for specific patterns.

![ ](/assets/images/mmon/image-20210301010323487.png)



To search within the process memory it use a combination of OpenProcess(), VirtualQueryEx(), ReadProcessMemory().

![ ](/assets/images/mmon/image-20210301011119684.png)



![ ](/assets/images/mmon/image-20210301011200805.png)



The tracks are validated with the Luhn algorithm.

![ ](/assets/images/mmon/image-20210301011535455.png)



As seen below, MMon was able to find the tracks within the notepad process.

![ ](/assets/images/mmon/finding_tracks.png)



## Conclusion

MMon is basically a simple command line tool to find credit card data and other patterns within process memory.
